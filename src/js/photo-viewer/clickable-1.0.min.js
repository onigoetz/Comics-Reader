/**
 * clickable.js v1.0
 * Seamless buttons for mobile devices
 * Copyright (c) 2012 Kik Interactive, http://kik.com
 * Released under the MIT license
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
var Clickable=function(f,j,k,h){var a=/^\s+|\s+$/g,m=40;var n=false,e=i();function i(){var v=f.navigator.userAgent,u,t,s;if((s=/\bCPU.*OS (\d+(_\d+)?)/i.exec(v))){u="ios";t=s[1].replace("_",".")}else{if((s=/\bAndroid (\d+(\.\d+)?)/.exec(v))){u="android";t=s[1]}}var w={name:u,version:t&&f.parseFloat(t)};w[u]=true;return w}function l(s){return String(s).replace(a,"")}function r(t){if(!t){return false}try{return(t instanceof Node)||(t instanceof HTMLElement)}catch(s){}if(typeof t!=="object"){return false}if(typeof t.nodeType!=="number"){return false}if(typeof t.nodeName!=="string"){return false}return true}function b(s){while(s=s.parentNode){if(s===j){return true}}return false}function o(){return e.ios||e.android}function d(J,K){if(!r(J)){throw TypeError("element "+J+" must be a DOM element")}if(J._clickable){return}J._clickable=true;switch(typeof K){case"undefined":K="active";case"string":break;default:throw TypeError("active class "+K+" must be a string")}J.setAttribute("data-clickable-class",K);var H=new RegExp("\\b"+K+"\\b"),F=false,s=false,I;if(!o()){if(J.addEventListener){J.addEventListener("mousedown",D,false);J.addEventListener("mousemove",E,false);J.addEventListener("mouseout",E,false);J.addEventListener("mouseup",B,false);J.addEventListener("click",z,false)}else{if(J.attachEvent){J.attachEvent("onmousedown",D);J.attachEvent("onmousemove",E);J.attachEvent("onmouseout",E);J.attachEvent("onmouseup",B);J.attachEvent("onclick",z)}}return}J.style["-webkit-tap-highlight-color"]="rgba(255,255,255,0)";J.addEventListener("click",z,false);if(e.ios){J.addEventListener("DOMNodeInsertedIntoDocument",L,false);J.addEventListener("DOMNodeRemovedFromDocument",A,false);if(b(J)){L()}}else{L()}function L(){J.addEventListener("touchstart",x,false);J.addEventListener("touchmove",C,false);J.addEventListener("touchend",w,false);J.addEventListener("touchcancel",C,false)}function A(){J.removeEventListener("touchstart",x);J.removeEventListener("touchmove",C);J.removeEventListener("touchend",w);J.removeEventListener("touchcancel",C)}function v(){J.className+=" "+K}function t(){J.className=l(J.className.replace(H,""))}function G(){n=true}function y(){if(n){setTimeout(function(){n=true},50)}}function u(N,M){do{if(N===M){return true}else{if(N._clickable){return false}}}while(N=N.parentNode);return false}function D(M){s=false;if(J.disabled||!u(M.target,J)){M.preventDefault();F=false;return}F=true;v()}function E(M){M.preventDefault();F=false;s=false;t()}function B(M){if(J.disabled){M.preventDefault();F=false;s=false;return}if(!F){M.preventDefault();s=false}else{s=true}F=false;t()}function x(M){s=false;if(n||J.disabled||(M.touches.length!==1)||!u(M.target,J)){F=false;return}n=true;F=true;I=+new Date();var N=I;setTimeout(function(){if(F&&(N===I)){v()}},m)}function C(M){s=false;F=false;if(M){n=false}if(J.disabled){return}t()}function w(P){var M=F;C();if(!M||J.disabled){n=false;return}if(!P.stopImmediatePropagation){s=true;return}var O=+new Date()-I;if(O>m){N()}else{v();setTimeout(function(){t();N()},1)}function N(){s=true;var Q=j.createEvent("MouseEvents");Q.initMouseEvent("click",true,true,f,1,0,0,0,0,false,false,false,false,0,null);J.dispatchEvent(Q)}}function z(M){M=M||f.event;if(!J.disabled&&s){s=false;setTimeout(function(){n=false},0);return}if(M.stopImmediatePropagation){M.stopImmediatePropagation()}M.preventDefault();M.stopPropagation();M.cancelBubble=true;M.returnValue=false;return false}}function q(u,t,s){if(!r(u)){throw TypeError("button must be a DOM element, got "+u)}switch(typeof t){case"string":break;case"function":s=t;t=undefined;break;default:throw TypeError("button active class must be a string if defined, got "+t)}if(typeof s!=="function"){throw TypeError("sticky click handler must be a function, got "+s)}d(u);u.addEventListener("click",v,false);function v(){var x=false,w=u.getAttribute("data-clickable-class")||"active",A;u.disabled=true;u.className+=" "+w;try{A=s(z)}catch(y){if(f.console&&f.console.error){f.console.error(y+"")}z()}if(A===false){z()}function z(){if(x){return}x=true;if(u.disabled){u.disabled=false;u.className=u.className.replace(new RegExp("\\b"+w+"\\b","g"),"")}}}}function g(){if(!k){return}k.extend(k.fn,{clickable:function(s){this.forEach(function(t){d(t,s)});return this},stickyClick:function(s){this.forEach(function(t){q(t,s)});return this}})}function p(){if(!h){return}h.fn.clickable=function(s){this.each(function(){d(this,s)});return this};h.fn.stickyClick=function(s){this.each(function(){q(this,s)});return this}}function c(){g();p();function s(){d.apply(this,arguments)}s.touchable=function(){return o()};s.sticky=function(){q.apply(this,arguments)};return s}return c()}(window,document,window.Zepto,window.jQuery);
